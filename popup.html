<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>DealPal - Tiny Price Tracker</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        width: 340px;
        padding: 12px;
        box-sizing: border-box;
        background: #fff;
      }

      h3 { margin: 0 0 8px 0; font-size: 18px; }
      h4 { margin: 12px 0 6px 0; font-size: 14px; }
      button { margin-top: 8px; padding: 6px 12px; font-size: 14px; cursor: pointer; }

      .item { border-bottom: 1px solid #eee; padding: 6px 0; }
      .small { font-size: 12px; color: #666; }
      #trackedList { max-height: 160px; overflow:auto; padding-right:6px; }
      .no-items { color:#777; font-size:13px; }

      #adContainer {
        margin-top: 12px;
        text-align: center;
        border-top: 1px solid #ddd;
        padding-top: 8px;
      }

      #affiliateBanner img {
        width: 80px;
        height:auto;
        display:block;
        margin:0 auto;
      }

      #supportButton button { width: 100%; }

      /* Consent row */
      .consent-row {
        display:flex;
        align-items:center;
        gap:8px;
        margin-top:8px;
        position:relative;
      }

      .consent-label {
        display:flex;
        align-items:center;
        gap:6px;
        font-size:13px;
        color:#222;
        cursor:pointer;
      }

      /* Info icon + tooltip */
      .info-wrap {
        position:relative;
        width:22px;
        height:22px;
        display:flex;
        align-items:center;
        justify-content:center;
      }

      .info-icon {
        width:20px;
        height:20px;
        border-radius:50%;
        background:#e6eefc;
        color:#1a73e8;
        font-weight:700;
        text-align:center;
        line-height:20px;
        font-size:12px;
        user-select:none;
        cursor:default;
      }

      /* Tooltip now opens DOWNWARD to avoid clipping */
      .tooltip {
        position:absolute;
        top:calc(100% + 8px);
        left:0;
        min-width:220px;
        max-width:260px;
        background:#222;
        color:#fff;
        padding:8px 10px;
        border-radius:6px;
        font-size:12px;
        line-height:1.35;
        box-shadow:0 6px 18px rgba(0,0,0,0.15);
        display:none;
        z-index:9999;
      }

      .tooltip::before {
        content:"";
        position:absolute;
        bottom:100%;
        left:10px;
        border-width:6px;
        border-style:solid;
        border-color:transparent transparent #222 transparent;
      }

      .info-wrap:hover .tooltip,
      .info-wrap:focus-within .tooltip {
        display:block;
      }
    </style>
  </head>

  <body>
    <h3>DealPal</h3>

    <div id="lastSeen" style="margin-bottom:8px;color:#333;"></div>
    <button id="scanBtn">Scan page for product</button>

    <div class="consent-row">
      <div class="info-wrap" tabindex="0">
        <span class="info-icon">i</span>
        <div class="tooltip">
          Sharing is anonymous and optional. If enabled, DealPal may send non-personal price change data in the future to help improve the product. No personal information or browsing history is collected.
        </div>
      </div>

      <label class="consent-label">
        <input type="checkbox" id="consent">
        Share anonymized price changes
      </label>
    </div>

    <h4>Tracked items</h4>
    <div id="trackedList">
      <div class="no-items">No tracked items yet.</div>
    </div>

    <div id="adContainer">
      <div id="affiliateBanner" style="margin-bottom:8px;">
        <a href="https://www.amazon.com/?tag=dealpal20-20" target="_blank" rel="noopener noreferrer">
          <img src="icons/going-to-work.png" alt="Shop on Amazon (supports DealPal)">
        </a>
        <div style="font-size:12px;margin-top:6px;color:#333;">
          Shop on Amazon (supports DealPal)
        </div>
      </div>

      <div id="supportButton">
        <a href="https://ko-fi.com/dealpal" target="_blank" rel="noopener noreferrer">
          <button id="supportBtn">Support DealPal</button>
        </a>
      </div>

      <div style="margin-top:8px;font-size:11px;color:#666;">
        Affiliate and support links help fund development.
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
